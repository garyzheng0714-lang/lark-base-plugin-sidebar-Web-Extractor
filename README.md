# Bitable Web Extractor · 多维网页提取器

一个基于 Vue 3 + Element-Plus 的飞书/企鹊多维表格（Bitable）侧边栏插件模板，用于从网页链接提取正文内容，并对 Amazon 畅销榜页面进行结构化解析（标题、侧栏层级、商品列表等），支持单条记录与整表批量更新。

## 功能特性
- 侧边栏插件：在 Bitable 中以 iframe 运行，集成 `@lark-base-open/js-sdk`。
- 正文提取：输入任意网页 URL，经 Reader 服务获取 HTML/Markdown，生成可写入文本字段的内容。
- 整表批量：从视图记录的“链接字段”批量提取并写入“输出字段”，可选写入“榜单名称”“商品列表”。
- Amazon 特化：识别 `.co.jp` 与多语言路径（`/-/ja|en|zh/`），解析畅销榜标题/层级/商品列表（排名、名称、评分/评论数/价格），并具备门页绕过与限速控制。
- 国际化支持：内置中文/英文/日文文案，根据域名自动设置 `Accept-Language`，对 `.co.jp` 自动修正语言路径。
- 主题适配：自动跟随多维表格的亮/暗主题，统一样式变量。
- 运行日志：内置简易日志工具，便于定位抓取与写入问题。

## 环境要求
- Node.js `>= 18.10`
- 现代浏览器（开发预览）
- 在多维表格侧边栏插件环境中运行以启用 JS SDK 能力（独立浏览器预览时部分能力不可用）

## 安装与启动
```bash
npm install
npm run dev
# 本地开发默认地址：http://localhost:5173/
```
在多维表格的插件开发或调试模式中，将插件指向本地开发地址后即可在侧边栏中看到界面并使用。

## 使用方法
### 单页正文提取（“正文提取”页签）
1. 在多维表格中选择数据表/视图/字段；
2. 在“链接字段”粘贴/选择包含 `http/https` 的链接；
3. 选择“输出字段”（文本类型），点击“提取正文”，预览并写入。

### 整表批量更新
1. 选择视图范围与“链接字段”（文本/公式/超链接均可）；
2. 选择“输出字段”（文本类型），可选“榜单名称”“商品列表”字段；
3. 点击“批量更新整表”，插件将按域名间隔与门页规避策略自动提取与写入；遇到 `.co.jp` 英文内容时会自动尝试 `/-/ja/` 回抓修正。

### 榜单层级提取（“榜单层级提取”页签）
- 面向 Amazon 畅销榜页面：解析当前分类与左侧层级结构，生成规范化文本，支持批量写入。

## 目录结构（简要）
```
src/
  views/            主界面：Form.vue（正文/批量），Hierarchy.vue（层级）
  services/         Reader 拉取与标题提取
  utils/            结构化解析与日志
  locales/          i18n 文案（en/zh/ja）
  hooks/            主题跟随（useTheme）
```

## 技术栈
- Vue 3（`<script setup>`）
- Element-Plus
- Vite
- `@lark-base-open/js-sdk`（0.4.0）
- `r.jina.ai` Reader 服务（页面读取与 Markdown 生成）

## 开发建议
- 在 Bitable 环境内调试 JS SDK 能力；独立浏览器预览仅用于快速 UI 验证。
- Amazon 页面存在门页与速率限制，代码已包含 UA/语言/退避重试与路径修正策略；批量写入时请关注日志输出。
- 国际化与主题：新增功能请同步维护 `src/locales/*` 与样式变量。

## 贡献指南
1. Fork 仓库并创建特性分支；
2. 保持代码风格与现有实现一致，必要处补充注释与 i18n 文案；
3. 在 Bitable 实际环境中验证主要流程（单页/批量/层级）；
4. 提交 Pull Request，说明变更范围、动机与测试方式。

## 许可证
本项目采用 MIT License，详见仓库 `LICENSE` 文件。

---
### 项目命名建议
- 英文名：`Bitable Web Extractor`
- 中文名：`多维网页提取器`

两者均能准确体现“在 Bitable 中进行网页正文与榜单结构化提取”的核心能力，简洁专业、便于记忆。
